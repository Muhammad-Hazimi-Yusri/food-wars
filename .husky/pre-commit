#!/bin/sh

# Check if feature files are staged (under src/)
FEATURE_FILES=$(git diff --cached --name-only | grep -E '^src/(app|components|lib)/' | head -1)

if [ -n "$FEATURE_FILES" ]; then
  PKG_STAGED=$(git diff --cached --name-only | grep '^package.json$')
  README_STAGED=$(git diff --cached --name-only | grep '^README.md$')
  
  if [ -z "$PKG_STAGED" ] || [ -z "$README_STAGED" ]; then
    echo ""
    echo "‚ö†Ô∏è  Feature files changed but version not bumped!"
    echo "   Run: pnpm version:bump"
    echo "   Then: git add package.json README.md"
    echo ""
  fi
fi

# Run linting
echo "üîç Running lint..."
pnpm lint || exit 1

echo ""
echo "‚úÖ Pre-commit checks passed"